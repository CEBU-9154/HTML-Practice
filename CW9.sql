CREATE TABLE IF NOT EXISTS Salesman(
SALESMAN_ID TEXT PRIMARY KEY,
NAME TEXT,
CITY TEXT,
COMISSION);

INSERT INTO Salesman(SALESMAN_ID,NAME,CITY,COMISSION)
VALUES
("5001","JAMES HOOG","NEW YORK","0.15"),
("5002","NAIL KNITE","PARIS","0.13"),
("5005","PIT ALEX","LONDON","0.11"),
("5006","MC LYON","PARIS","0.14"),
("5007","PAUL ADAM","ROME","0.13"),
("5003","LAUSON HEN","SAN JOSE","0.12");
SELECT * FROM Salesman;

CREATE TABLE IF NOT EXISTS Customer(
CUSTOMER_ID TEXT,
CUST_NAME TEXT PRIMARY KEY,
CITY TEXT,
GRADE TEXT,
SALESMAN_ID TEXT);
INSERT INTO Customer(CUSTOMER_ID,CUST_NAME,CITY,GRADE,SALESMAN_ID)
VALUES
("3002","NICK RIMANDO","NEW YORK","100","5001"),
("3007","BRAD DAVIS","NEW YORK","200","5001"),
("3005","GRAHAM ZUSI","CALIFORNIA","200","5001"),
("3008","JULIAN GREEN","LONDON","300","5001"),
("3004","FABIAN JOHNSON","PARIS","300","5001"),
("3009","GEFF CAMERON","BERLIN","100","5001"),
("3003","JOZY ALTIDOR","MOSCOW","200","5001"),
("3001","BRAD GUZAN","LONDON","0","5001");
SELECT * FROM Customer;

CREATE TABLE IF NOT EXISTS Orders(
    ORD_NO TEXT PRIMARY KEY,
    PURCH_AMT TEXT,
    ORD_DATE TEXT,
    CUSTOMER_ID TEXT,
    SALESMAN_ID TEXT);

INSERT INTO Orders(ORD_NO,PURCH_AMT,ORD_DATE,CUSTOMER_ID,SALESMAN_ID)
VALUES
("70001","150.5","2012-10-05","3005","5002"),
("70009","270.65","2012-09-10","3001","5001"),
("70002","65.26","2012-10-05","3002","5003"),
("70004","110.5","2012-08-17","30095","5007"),
("70007","948.5","2012-09-10","3005","5005"),
("70006","2400.6","2012-07-27","3007","5006");
SELECT * FROM Orders;

SELECT CUSTOMER.CUST_NAME, SALESMAN.NAME, SALESMAN.CITY
FROM Customer
JOIN Salesman ON CUSTOMER.CITY =SALESMAN.CITY;

SELECT CUSTOMER.CUST_NAME, SALESMAN.NAME, SALESMAN.CITY
FROM Customer
JOIN Salesman ON CUSTOMER.SALESMAN_ID =SALESMAN.SALESMAN_ID;

SELECT ORDERS.ORD_NO, CUSTOMER.CUST_NAME, ORDERS.CUSTOMER_ID, ORDERS.SALESMAN_ID
FROM Orders
JOIN Customer ON ORDERS.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID
JOIN Salesman ON ORDERS.SALESMAN_ID = SALESMAN.SALESMAN_ID
WHERE Customer.CITY <> SALESMAN.CITY;

SELECT Orders.ORD_NO, Customer.CUST_NAME
FROM Orders
JOIN Customer ON Orders.CUSTOMER_ID=Customer.CUSTOMER_ID;

SELECT Customer.cust_name AS "Custoer", Customer.grade AS "Grade"
FROM Orders
JOIN Salesman ON Orders.SALESMAN_ID=Salesman.SALESMAN_ID
JOIN Customer ON Orders.CUSTOMER_ID=Customer.CUSTOMER_ID
WHERE Customer.grade IS NOT NULL;

SELECT Customer.CUST_NAME AS "CUSTOMER",
Customer.CITY AS "CITY",
Salesman.NAME AS "SALESMAN",
Salesman.COMISSION
FROM Customer
JOIN Salesman ON Customer.SALESMAN_ID=Salesman.SALESMAN_ID
WHERE Salesman.COMISSION BETWEEN 0.12 and 0.14;

SELECT Orders.ORD_NO, Customer.CUST_NAME, Salesman.COMISSION AS "COMISSION%",
Orders.PURCH_AMT * SALESMAN.COMISSION AS "COMISSION"
FROM Orders
JOIN Salesman ON Orders.SALESMAN_ID = Salesman.SALESMAN_ID
JOIN Customer ON Orders.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID
WHERE Customer.grade >=200;

SELECT *
FROM Customer
JOIN Orders ON Customer.CUSTOMER_ID=Orders.CUSTOMER_ID
WHERE Orders.ORD_DATE='2012-10-05';